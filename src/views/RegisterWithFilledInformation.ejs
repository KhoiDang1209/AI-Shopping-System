<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login page</title>
    <link rel="stylesheet" href="/css/Register.css">
</head>

<body>
    <div class="container">
        <img src="/images/login.png" alt="Login page">
        <div class="Title">Register</div>
        <div class="Register_form">
            <form action="/registerUser" method="post">
                <fieldset>
                    <legend>Register</legend>
                    <div class="input-group">
                        <label>Country: </label>
                        <select name="country" id="country" required>
                            <option value="<%= country %>">
                                <%= country %>
                            </option>
                            <% countries.forEach(function(country, index) { %>
                                <option>
                                    <%= country.name %>
                                </option>
                                <% }); %>
                        </select>
                    </div>
                    <div class="input-row">
                        <div class="input-group">
                            <label>First Name:</label>
                            <input type="text" name="firstname" value="<%= firstname %>" required>
                        </div>
                        <div class="input-group">
                            <label>Last Name:</label>
                            <input type="text" name="lastname" value="<%= lastname %>" required>
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-row">
                            <div class="input-group">
                                <label>Unit Number:</label>
                                <input type="text" name="unitnumber" value="<%= unitnumber %>" required>
                            </div>
                            <div class="input-group">
                                <label>Street number:</label>
                                <input type="text" name="streetnumber" value="<%= streetnumber %>" required>
                            </div>
                        </div>
                    </div>

                    <div class="input-group" id="city-container">
                        <% if (country==='VIET NAM' ) { %>
                            <label for="city">City:</label>
                            <select name="city" id="city" required>
                                <option value="<%= city %>">
                                    <%= city %>
                                </option>
                                <% listCitys.forEach(function(cityObj) { %>
                                    <option>
                                        <%= cityObj.name %>
                                    </option>
                                    <% }); %>
                            </select>
                            <% } else { %>
                                <label>City: </label>
                                <input type="text" name="city" id="city" value="<%= city %>" required>
                                <% } %>
                    </div>
                    <div class="input-group">
                        <label>Address line 1: </label>
                        <input type="text" name="Addressline1" value="<%= Addressline1 %>" required>
                    </div>
                    <div class="input-group">
                        <label>Address line 2: </label>
                        <input type="text" name="Addressline2" value="<%= Addressline2 %>" required>
                    </div>
                    <div class="input-group">
                        <label>Postal code: </label>
                        <input type="text" name="Postalcode" value="<%= Postalcode %>" required>
                    </div>
                    <div class="input-group">
                        <label>Email: </label>
                        <input type="text" name="email" value="<%= email %>" required>
                    </div>
                    <div class="input-group">
                        <label>User Name: </label>
                        <input type="text" name="username" value="<%= username %>" required>
                    </div>
                    <div class="input-group">
                        <label>Password: </label>
                        <input type="password" name="password" value="<%= password %>" required>
                    </div>
                    <div class="input-group">
                        <label for="Dob">Date Of Birth:</label>
                        <input type="date" id="dob" name="dob" min="1900-01-01" max="2025-12-31" value="<%= dob %>"
                            required>
                    </div>
                    <div class="input-group">
                        <label for="Dob">Phone Number:</label>
                        <input type="text" name="PhoneNumber" value="<%= PhoneNumber %>" required>
                    </div>
                    <div>
                        <button type="submit">Register</button>
                    </div>
                </fieldset>
            </form>
            <div class="input-group">
                <label>Already have account? </label>
            </div>
            <div class="Login">
                <form action="/" method="get">
                    <button type="submit">Login</button>
                </form>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const countryElement = document.getElementById('country');
            const cityContainer = document.getElementById('city-container');

            // Function to update the city field
            function updateCityField(selectedCountry, currentCity) {
                if (selectedCountry === 'VIET NAM') {
                    // Replace input with dropdown for Vietnamese cities
                    cityContainer.innerHTML = `
                <div class="input-group">
                    <label for="city">City:</label>
                    <select name="city" id="city" required>
                        <option value="">--Select a City--</option>
                        <% listCitys.forEach(function(cityObj) { %>
                            <option value="<%= cityObj.name %>" ${currentCity === '<%= cityObj.name %>' ? 'selected' : ''}>
                                <%= cityObj.name %>
                            </option>
                        <% }); %>
                    </select>
                </div>
            `;
                } else {
                    // Replace dropdown with text input for other countries
                    cityContainer.innerHTML = `
                <label>City: </label>
                <input type="text" name="city" id="city" value="${currentCity || ''}" required>
            `;
                }
            }

            // Initial load check
            const initialCountry = countryElement.value;
            const initialCity = '<%= city %>'; // Preloaded city value
            updateCityField(initialCountry, initialCity);

            // Handle country change
            countryElement.addEventListener('change', function () {
                const currentCity = document.getElementById('city') ? document.getElementById('city').value : '';
                updateCityField(this.value, currentCity);
            });
        });
    </script>
</body>

</html>